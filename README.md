# Recognize fruits automatically
Building AI course project

## Summary
Objective: Recognizing automatically fruits from images with the help of VGG16 and PCA . 

Description: 
I developed in a Big Data environment a first data processing chain of images of fruits which includes preprocessing and a dimension reduction with VGG16 and PCA. The purpose is to recognize different fruits automatically from images. I started by creating an Amazon account and a bucket where the photos can be uploaded. Also created an EC2 server which could be used to pre-process photos. After that, I created a Databricks account. The company provides a free account for two-weeks; where it is possible to configure the account with the AWS bucket and create a cluster to preprocess the images. Databricks also provides a notebook environment to facilitate data downloading and processing. I then did the preprocessing and dimension reduction on Databricks with pyspark. I saved the parquet creation file to the docs on github.

The original datasetconsisted of over 90,000 100x100 PIXEL images of 131 different fruits. Size is 1:03 GB. From all this data, I took 642 images of four different fruits to test the Big Data architecture. Images were pre-processed and dimesion was reduecd using apache spark which is a cluster computing technology for big data processing. Spark's in-memory cluster computing dramatically increases processing speed. Databricks that we used in this project were created by the original Apache Sparkâ„¢ developers. It can launch cloud-optimized Spark clusters for free in minutes. Key features of Databricks include: cloud-managed Spark clusters and notebook environment. The cluster on databricks had 30.5 GB of memory and four cores; the driver too. I could also configure databricks with my AWS bucket to show that I can download the images without passing my secret key and credentials each time. Once all this was done, I was able to resize the images with apache spark to size 244x244. Then I run the images through our pretrained VGG16 model and took the last layer of the network to ru it through PCA. We see here that the 16 principal components explain at least 85% of the total variance.This illustration of the first two characteristics of PCA shows that we can very well distinguish fruits that have a different shape/color - bananas are apart from avocados and apricots and apples.
